<!doctype html> <html lang=en > <a id=top ></a> <link rel=icon  href="/assets/favicon.png"> <link rel=icon  type="image/x-icon" href="/assets/favicon.png"> <link rel=icon  type="image/png" href="/assets/favicon.png"/> <link rel=icon  href="/assets/main img.jpg"> <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> <link rel=stylesheet  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/styles/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_hyde.css"> <link rel=icon  href="/assets/favicon.png"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <title>P18</title> <!-- <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> <script> const PlotlyJS_json = async (div, url) => { console.log("url: ",url); console.log("div: ",div); response = await fetch(url); fig = await response.json(); if (typeof fig.config === 'undefined') { fig["config"]={} } delete fig.layout.width delete fig.layout.height fig["layout"]["autosize"] = true fig["config"]["autosizable"] = true fig["config"]["responsive"] = true fig.config["scrollZoom"] = false delete fig.config.staticPlot delete fig.config.displayModeBar delete fig.config.doubleClick delete fig.config.showTips Plotly.newPlot(div, fig); }; </script> --> <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> <script> const PlotlyJS_json = async (div, url) => { response = await fetch(url); fig = await response.json(); Plotly.newPlot(div, fig); }; </script> <!-- <a class=backToTopBtn  title="back to top // torna in cima" href="#top"> <span class=backToTopBtn-icon >^</span> </a> --> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <!-- <h1><a href="/">Hyde</a></h1> <p class=lead >A two-column theme.</p> --> <h1><a href="/">Eccoci.<img style="display: block; margin: 0 auto; margin-bottom: 20px"; width=170 ; src="/assets/main img.jpg" alt="main img"/></a></h1> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/">Home</a> <a class="sidebar-nav-item " href="/activity/">Attivit√†</a> <a class="sidebar-nav-item " href="/libri/">Libri</a> <a class="sidebar-nav-item " href="/uni/">Uni</a> <a class="sidebar-nav-item " href="/portfolio/">Portfolio</a> </nav> <a href="https://www.youtube.com/channel/UC1_68R2Kv1htcZ1It5il7CQ" target=_blank rel=noopener> <i class="fab fa-youtube big-icon"></i></a> <a href="https://www.instagram.com/divergentissimo/" target=_blank rel=noopener> <i class="fab fa-instagram big-icon"></i></a> <a href="https://www.linkedin.com/in/federico-angelo-mor/" target=_blank rel=noopener> <i class="fab fa-linkedin big-icon"></i></a> <a href="https://github.com/federicomor" target=_blank rel=noopener> <i class="fab fa-github big-icon"></i></a> </div> </div> <div class="content container"> <a class=backToTopBtn  title="back to top // torna in cima" href="#top"> <span class=backToTopBtn-icon >‚àß</span> </a> <div class=franklin-content > <div class=navigation_symbols > <form action="" method=get  onsubmit="location.href='/activity/project_euler/problem_' + this.elements[0].value; return false;" style="display:inline;"> <input title="go to problem" type="" placeholder=" " required style="margin-right: 5px; width: 40px; padding: 3px; text-align: center; border: 1px solid #666666; border-radius: 4px;"> </form> <a href="/activity/project_euler/problem_17/" style="color: black; text-decoration: none;"><i class="fa-solid fa-arrow-left"></i></a> <a href="javascript:void(0)" onclick="getRandomProblem()" style="color: black; text-decoration: none;" title="random problem">üé≤ </a> <script> function getRandomProblem() { fetch('/activity/project_euler/data.txt') .then(response => response.text()) .then(data => { const maxProblems = parseInt(data.trim(), 10); const randomProblemNumber = Math.floor(Math.random() * maxProblems) + 1; window.location = '/activity/project_euler/problem_' + randomProblemNumber + '/'; }) .catch(err => console.error('Error fetching max problems:', err)); } </script> <a href="/activity/project_euler" style="color: black; text-decoration: none;">üè† </a> <a href="/activity/project_euler/problem_19/" style="color: black; text-decoration: none;"><i class="fa-solid fa-arrow-right"></i></a> </div> <link rel=stylesheet  type="text/css" href="/activity/project_euler/style_main.1735430422.css"> <link rel=stylesheet  type="text/css" href="/activity/project_euler/style_default.1627113674.css"> <script src="https://projecteuler.net/js/mathjax_config.js"></script> <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?version=4.8.0&features=es6"></script> <script id=MathJax-script  async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script> <div id=content > <div class="center print"><img src="https://projecteuler.net/images/clipart/print_page_logo.png" alt=projecteuler.net ></div> <h2>Maximum Path Sum I</h2><div id=problem_icons  class=noprint ><span class=tooltip >‚ÑπÔ∏è<span class=tooltiptext_right >Published on Friday, 31st May 2002, 06:00 pm; Solved by 157035;<br>Difficulty rating: 5%</span></span></div><div id=problem_info ><h3><a href="https://projecteuler.net/problem=18">Problem 18</a></h3></div> <div class=problem_content  role=problem > <p>By starting at the top of the triangle below and moving to adjacent numbers on the row below, the maximum total from top to bottom is $23$.</p> <p class="monospace center"><span class=red ><b>3</b></span><br><span class=red ><b>7</b></span> 4<br> 2 <span class=red ><b>4</b></span> 6<br> 8 5 <span class=red ><b>9</b></span> 3</p> <p>That is, $3 + 7 + 4 + 9 = 23$.</p> <p>Find the maximum total from top to bottom of the triangle below:</p> <p class="monospace center">75<br> 95 64<br> 17 47 82<br> 18 35 87 10<br> 20 04 82 47 65<br> 19 01 23 75 03 34<br> 88 02 77 73 07 63 67<br> 99 65 04 28 06 16 70 92<br> 41 41 26 56 83 40 80 70 33<br> 41 48 72 33 47 32 37 16 94 29<br> 53 71 44 65 25 43 91 52 97 51 14<br> 70 11 33 28 77 73 17 78 39 68 17 57<br> 91 71 52 38 17 14 91 43 58 50 27 29 48<br> 63 66 04 68 89 53 67 30 73 16 69 87 40 31<br> 04 62 98 27 23 09 70 98 73 93 38 53 60 04 23</p> <p class=note ><b>NOTE:</b> As there are only $16384$ routes, it is possible to solve this problem by trying every route. However, <a href="https://projecteuler.net/problem=67">Problem 67</a>, is the same challenge with a triangle containing one-hundred rows; it cannot be solved by brute force, and requires a clever method! ;o)</p> </div><br> <br> </div> <!--end_content--> <h2 id=soluzione ><a href="#soluzione" class=header-anchor >Soluzione</a></h2> <p><p>Impostiamo i numeri dentro alla matrice \(M\). Ci interessa trovare al somma massima ottenibile percorrendo \(M\) da cima a fondo e spostandoci con passi adiacenti. L&#39;idea quindi √® di partire dal numero in cima e scendere calcolando tutti i possibili valori che possiamo ottenere sommando quel numero ai numeri a lui adiacenti nella riga sotto, ovvero quello in basso a sinitra e quello in basso a destra &#40;nella rappresentazione originale a triangolo&#41;. Di questi risultati, ci salviamo &#40;in un&#39;altra matrice \(M_\text{sum}\)&#41; il massimo tra di loro, ovvero quando ad una cella possono contribuire diversi &quot;percorsi&quot; di somme selezioniamo quello che conduce alla somma pi√π alta. Alla fine prendiamo il massimo valore che incontriamo sulla sua ultima riga: questo corrisponder√† infatti al valore di somma massimo ottenibile.<br />L&#39;idea funziona perch√© √® come se filtrassimo di volta in volta l&#39;informazione contenuta in M: se siamo alla riga 5 non ci interessano precisamente tutti i numeri nelle righe dalla 1 alla 4, ma piuttosto solo il loro effetto, cio√® le somme pi√π alte che loro sono riusciti a generare.</p> <p>Ad esempio, nel caso che segue partiamo con la matrice \(M\) che nella prima riga contiene il numero 75. La seconda riga di \(M_\text{sum}\) conterr√† quindi 75&#43;95 e 75&#43;64, senza troppi pensieri. La terza riga diventa ora interessante perch√© si aprono diversi percorsi. Ad esempio, nella prima cella di \(M_\text{sum}\) mettiamo il massimo tra 75&#43;95&#43;17 &#40;il percorso sempre dritto verso il basso&#41; e 75&#43;64&#43;17 &#40;il percorso che al secondo step devia verso destra&#41;. Allo stesso modo si procede nelle altre celle.</p> <pre><code class=language-julia >M &#61;&#91;
75 00 00 00 00 00 00 00 00 00 00 00 00 00 00
95 64 00 00 00 00 00 00 00 00 00 00 00 00 00
17 47 82 00 00 00 00 00 00 00 00 00 00 00 00
18 35 87 10 00 00 00 00 00 00 00 00 00 00 00
20 04 82 47 65 00 00 00 00 00 00 00 00 00 00
19 01 23 75 03 34 00 00 00 00 00 00 00 00 00
88 02 77 73 07 63 67 00 00 00 00 00 00 00 00
99 65 04 28 06 16 70 92 00 00 00 00 00 00 00
41 41 26 56 83 40 80 70 33 00 00 00 00 00 00
41 48 72 33 47 32 37 16 94 29 00 00 00 00 00
53 71 44 65 25 43 91 52 97 51 14 00 00 00 00
70 11 33 28 77 73 17 78 39 68 17 57 00 00 00
91 71 52 38 17 14 91 43 58 50 27 29 48 00 00
63 66 04 68 89 53 67 30 73 16 69 87 40 31 00
04 62 98 27 23 09 70 98 73 93 38 53 60 04 23
&#93;

R, C &#61; size&#40;M&#41;
Msum &#61; copy&#40;M&#41;

@time for i in 2:R
	for j in 1:C
		if j&#61;&#61;1
			Msum&#91;i,j&#93; &#61; Msum&#91;i-1,j&#93; &#43; M&#91;i,j&#93;
		else
			Msum&#91;i,j&#93; &#61; max&#40;Msum&#91;i-1,j&#93; &#43; M&#91;i,j&#93;, Msum&#91;i-1,j-1&#93; &#43; M&#91;i,j&#93;&#41;
		end
	end
end</code></pre><pre><code class="plaintext code-output">  0.005866 seconds (1.02 k allocations: 29.891 KiB, 98.00% compilation time)
</code></pre> <pre><code class=language-julia >for i in 1:R
	for j in 1:C
		print&#40;rpad&#40;Msum&#91;i,j&#93;,5, &quot; &quot;&#41;&#41;
	end
	println&#40;&#41;
end</code></pre><pre><code class="plaintext code-output">75   0    0    0    0    0    0    0    0    0    0    0    0    0    0    
170  139  0    0    0    0    0    0    0    0    0    0    0    0    0    
187  217  221  0    0    0    0    0    0    0    0    0    0    0    0    
205  252  308  231  0    0    0    0    0    0    0    0    0    0    0    
225  256  390  355  296  0    0    0    0    0    0    0    0    0    0    
244  257  413  465  358  330  0    0    0    0    0    0    0    0    0    
332  259  490  538  472  421  397  0    0    0    0    0    0    0    0    
431  397  494  566  544  488  491  489  0    0    0    0    0    0    0    
472  472  520  622  649  584  571  561  522  0    0    0    0    0    0    
513  520  592  655  696  681  621  587  655  551  0    0    0    0    0    
566  591  636  720  721  739  772  673  752  706  565  0    0    0    0    
636  602  669  748  798  812  789  850  791  820  723  622  0    0    0    
727  707  721  786  815  826  903  893  908  870  847  752  670  0    0    
790  793  725  854  904  879  970  933  981  924  939  934  792  701  0    
794  855  891  881  927  913  1040 1068 1054 1074 977  992  994  796  724  
</code></pre> <pre><code class=language-julia >@show maximum&#40;Msum&#91;end,:&#93;&#41;</code></pre><pre><code class="plaintext code-output">maximum(Msum[end, :]) = 1074
</code></pre> <p>Possiamo anche provare a ricostruire il percorso della soluzione scorrendo \(M_\text{sum}\) dal basso verso l&#39;alto e cofrontandola con \(M\).</p> <pre><code class=language-julia >cfr &#61; maximum&#40;Msum&#91;end,:&#93;&#41;
# se siamo in fondo il target √® il massimo valore, la somma pi√π alta
j_focus &#61; argmax&#40;Msum&#91;end,:&#93;&#41;
for i in R:-1:1
	if i&lt;R
		global cfr &#61; cfr - M&#91;i&#43;1,j_focus&#93;
		# altrimenti il target diventa la somma parziale meno il numero che c&#39;era in M
		global j_focus &#61; findfirst&#40;x -&gt; x&#61;&#61;cfr, Msum&#91;i,:&#93;&#41;
	end
	for j in 1:C
		if j&#61;&#61;j_focus
			print&#40;rpad&#40;&quot;&#91;&#36;&#40;M&#91;i,j&#93;&#41;&#93;&quot;,7, &quot; &quot;&#41;&#41;
		else
			print&#40;rpad&#40;M&#91;i,j&#93;,7, &quot; &quot;&#41;&#41;
		end
	end
	println&#40;&#41;
end</code></pre><pre><code class="plaintext code-output">4      62     98     27     23     9      70     98     73     [93]   38     53     60     4      23     
63     66     4      68     89     53     67     30     [73]   16     69     87     40     31     0      
91     71     52     38     17     14     91     43     [58]   50     27     29     48     0      0      
70     11     33     28     77     73     17     [78]   39     68     17     57     0      0      0      
53     71     44     65     25     43     [91]   52     97     51     14     0      0      0      0      
41     48     72     33     47     [32]   37     16     94     29     0      0      0      0      0      
41     41     26     56     [83]   40     80     70     33     0      0      0      0      0      0      
99     65     4      [28]   6      16     70     92     0      0      0      0      0      0      0      
88     2      77     [73]   7      63     67     0      0      0      0      0      0      0      0      
19     1      23     [75]   3      34     0      0      0      0      0      0      0      0      0      
20     4      [82]   47     65     0      0      0      0      0      0      0      0      0      0      
18     35     [87]   10     0      0      0      0      0      0      0      0      0      0      0      
17     47     [82]   0      0      0      0      0      0      0      0      0      0      0      0      
95     [64]   0      0      0      0      0      0      0      0      0      0      0      0      0      
[75]   0      0      0      0      0      0      0      0      0      0      0      0      0      0      
</code></pre> <p>Dicevo &quot;provare&quot; perch√© questo metodo a volte pu√≤ sbagliare, dato che opera su confronti aritmetici, che possono risultare ambigui in caso ci siano pi√π numeri che soddisfano la condizione. Perci√≤ occorre invece aggiornare la funzione sopra che assembla la soluzione per tenere anche traccia dei predecessori usati nel percorso ottimale.</p> <pre><code class=language-julia >parent &#61; zeros&#40;Int,R, C&#41;
for i in 2:R
    for j in 1:i
        if j &#61;&#61; 1
            Msum&#91;i,j&#93; &#61; Msum&#91;i-1,j&#93; &#43; M&#91;i,j&#93;
            parent&#91;i,j&#93; &#61; j
        else
			# sciogliamo il max tra i due casi per aggiornare correttamente parent
            if Msum&#91;i-1,j&#93; &gt; Msum&#91;i-1,j-1&#93;
                Msum&#91;i,j&#93; &#61; Msum&#91;i-1,j&#93; &#43; M&#91;i,j&#93;
                parent&#91;i,j&#93; &#61; j
            else
                Msum&#91;i,j&#93; &#61; Msum&#91;i-1,j-1&#93; &#43; M&#91;i,j&#93;
                parent&#91;i,j&#93; &#61; j-1
            end
        end
    end
end
j_focus &#61; argmax&#40;Msum&#91;end, :&#93;&#41;
path &#61; Int&#91;&#93;
path_indices &#61; zeros&#40;Int,R&#41;
for i in R:-1:1
	push&#33;&#40;path, M&#91;i,j_focus&#93;&#41;
    global path_indices&#91;i&#93; &#61; j_focus
    global j_focus &#61; parent&#91;i,j_focus&#93;
end
@show path sum&#40;path&#41;</code></pre><pre><code class="plaintext code-output">path = [93, 73, 58, 78, 91, 32, 83, 28, 73, 75, 82, 87, 82, 64, 75]
sum(path) = 1074
</code></pre> <pre><code class=language-julia >for i in 1:R
    for j in 1:i
        if j &#61;&#61; path_indices&#91;i&#93;
            print&#40;rpad&#40;&quot;&#91;&#36;&#40;M&#91;i,j&#93;&#41;&#93;&quot;,5,&quot; &quot;&#41;&#41;
        else
            print&#40;rpad&#40;M&#91;i,j&#93;,5,&quot; &quot;&#41;&#41;
        end
    end
    println&#40;&#41;
end</code></pre><pre><code class="plaintext code-output">[75] 
95   [64] 
17   47   [82] 
18   35   [87] 10   
20   4    [82] 47   65   
19   1    23   [75] 3    34   
88   2    77   [73] 7    63   67   
99   65   4    [28] 6    16   70   92   
41   41   26   56   [83] 40   80   70   33   
41   48   72   33   47   [32] 37   16   94   29   
53   71   44   65   25   43   [91] 52   97   51   14   
70   11   33   28   77   73   17   [78] 39   68   17   57   
91   71   52   38   17   14   91   43   [58] 50   27   29   48   
63   66   4    68   89   53   67   30   [73] 16   69   87   40   31   
4    62   98   27   23   9    70   98   73   [93] 38   53   60   4    23   
</code></pre> <script src="https://giscus.app/client.js" data-repo="federicomor/federicomor.github.io" data-repo-id=R_kgDOLBdBYA  data-category=Announcements  data-category-id=DIC_kwDOLBdBYM4Clm0M  data-mapping=url  data-strict=0  data-reactions-enabled=1  data-emit-metadata=0  data-input-position=bottom  data-theme=preferred_color_scheme  data-lang=it  // data-loading=lazy  crossorigin=anonymous  async> </script> </p> <div class=page-foot > Last modified: September 20, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the lovely <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> <!-- <script src="/libs/katex/katex.min.js"></script> <script src="/libs/katex/contrib/auto-render.min.js"></script> <script>renderMathInElement(document.body)</script> --> <script> MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$','$$'], ['\\[','\\]']], tags: 'all' }, svg: {fontCache: 'global'} }; </script> <script id=MathJax-script  async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script> <script src="/libs/highlight/highlight.min.js"></script> <script>hljs.highlightAll();hljs.configure({tabReplace: ' '});</script>