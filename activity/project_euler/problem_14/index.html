<!doctype html> <html lang=en > <a id=top ></a> <link rel=icon  href="/assets/favicon.png"> <link rel=icon  type="image/x-icon" href="/assets/favicon.png"> <link rel=icon  type="image/png" href="/assets/favicon.png"/> <link rel=icon  href="/assets/main img.jpg"> <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> <link rel=stylesheet  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/styles/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_hyde.css"> <link rel=icon  href="/assets/favicon.png"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <title>P14</title> <!-- <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> <script> const PlotlyJS_json = async (div, url) => { console.log("url: ",url); console.log("div: ",div); response = await fetch(url); fig = await response.json(); if (typeof fig.config === 'undefined') { fig["config"]={} } delete fig.layout.width delete fig.layout.height fig["layout"]["autosize"] = true fig["config"]["autosizable"] = true fig["config"]["responsive"] = true fig.config["scrollZoom"] = false delete fig.config.staticPlot delete fig.config.displayModeBar delete fig.config.doubleClick delete fig.config.showTips Plotly.newPlot(div, fig); }; </script> --> <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> <script> const PlotlyJS_json = async (div, url) => { response = await fetch(url); fig = await response.json(); Plotly.newPlot(div, fig); }; </script> <!-- <a class=backToTopBtn  title="back to top // torna in cima" href="#top"> <span class=backToTopBtn-icon >^</span> </a> --> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <!-- <h1><a href="/">Hyde</a></h1> <p class=lead >A two-column theme.</p> --> <h1><a href="/">Eccoci.<img style="display: block; margin: 0 auto; margin-bottom: 20px"; width=170 ; src="/assets/main img.jpg" alt="main img"/></a></h1> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/">Home</a> <a class="sidebar-nav-item " href="/activity/">Attivit√†</a> <a class="sidebar-nav-item " href="/libri/">Libri</a> <a class="sidebar-nav-item " href="/uni/">Uni</a> <a class="sidebar-nav-item " href="/portfolio/">Portfolio</a> </nav> <a href="https://www.youtube.com/channel/UC1_68R2Kv1htcZ1It5il7CQ" target=_blank rel=noopener> <i class="fab fa-youtube big-icon"></i></a> <a href="https://www.instagram.com/divergentissimo/" target=_blank rel=noopener> <i class="fab fa-instagram big-icon"></i></a> <a href="https://www.linkedin.com/in/federico-angelo-mor/" target=_blank rel=noopener> <i class="fab fa-linkedin big-icon"></i></a> <a href="https://github.com/federicomor" target=_blank rel=noopener> <i class="fab fa-github big-icon"></i></a> </div> </div> <div class="content container"> <a class=backToTopBtn  title="back to top // torna in cima" href="#top"> <span class=backToTopBtn-icon >‚àß</span> </a> <div class=franklin-content > <div class=navigation_symbols > <form action="" method=get  onsubmit="location.href='/activity/project_euler/problem_' + this.elements[0].value; return false;" style="display:inline;"> <input title="go to problem" type="" placeholder=" " required style="margin-right: 5px; width: 40px; padding: 3px; text-align: center; border: 1px solid #666666; border-radius: 4px;"> </form> <a href="/activity/project_euler/problem_13/" style="color: black; text-decoration: none;"><i class="fa-solid fa-arrow-left"></i></a> <a href="javascript:void(0)" onclick="getRandomProblem()" style="color: black; text-decoration: none;" title="random problem">üé≤ </a> <script> function getRandomProblem() { fetch('/activity/project_euler/data.txt') .then(response => response.text()) .then(data => { const maxProblems = parseInt(data.trim(), 10); const randomProblemNumber = Math.floor(Math.random() * maxProblems) + 1; window.location = '/activity/project_euler/problem_' + randomProblemNumber + '/'; }) .catch(err => console.error('Error fetching max problems:', err)); } </script> <a href="/activity/project_euler" style="color: black; text-decoration: none;">üè† </a> <a href="/activity/project_euler/problem_15/" style="color: black; text-decoration: none;"><i class="fa-solid fa-arrow-right"></i></a> </div> <link rel=stylesheet  type="text/css" href="/activity/project_euler/style_main.1735430422.css"> <link rel=stylesheet  type="text/css" href="/activity/project_euler/style_default.1627113674.css"> <script src="https://projecteuler.net/js/mathjax_config.js"></script> <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?version=4.8.0&features=es6"></script> <script id=MathJax-script  async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script> <div id=content > <div class="center print"><img src="https://projecteuler.net/images/clipart/print_page_logo.png" alt=projecteuler.net ></div> <h2>Longest Collatz Sequence</h2><div id=problem_icons  class=noprint ><span class=tooltip >‚ÑπÔ∏è<span class=tooltiptext_right >Published on Friday, 5th April 2002, 06:00 pm; Solved by 244286;<br>Difficulty rating: 5%</span></span></div><div id=problem_info ><h3><a href="https://projecteuler.net/problem=14">Problem 14</a></h3></div> <div class=problem_content  role=problem > <p>The following iterative sequence is defined for the set of positive integers:</p> <ul style="list-style-type:none;"> <li>$n \to n/2$ ($n$ is even) <li>$n \to 3n + 1$ ($n$ is odd)</ul> <p>Using the rule above and starting with $13$, we generate the following sequence: $$13 \to 40 \to 20 \to 10 \to 5 \to 16 \to 8 \to 4 \to 2 \to 1.$$</p> <p>It can be seen that this sequence (starting at $13$ and finishing at $1$) contains $10$ terms. Although it has not been proved yet (Collatz Problem), it is thought that all starting numbers finish at $1$.</p> <p>Which starting number, under one million, produces the longest chain?</p> <p class=note ><b>NOTE:</b> Once the chain starts the terms are allowed to go above one million.</p> </div><br> <br> </div> <!--end_content--> <h2 id=soluzione ><a href="#soluzione" class=header-anchor >Soluzione</a></h2> <p><p>Potremmo semplicemente scorrere sui numeri da uno a un milione, usare questa funzione per generare la sequenza di numeri prodotti, e guardare il numero che produce quella pi√π lunga.</p> <pre><code class=language-julia >function simple_collatz&#40;n; verbose&#61;false&#41;
	steps &#61; 1
	if verbose println&#40;&quot;&#40;step&#61;&#36;steps&#41; &#36;n&quot;&#41; end
	while true
		if iseven&#40;n&#41;
			n &#61; div&#40;n,2&#41;
		else
			n &#61; 3n&#43;1
		end
		steps &#43;&#61; 1

		if verbose println&#40;&quot;&#40;step&#61;&#36;steps&#41; &#36;n&quot;&#41; end
		if n&#61;&#61;1
			break
		end
	end
	return steps
end
simple_collatz&#40;50, verbose&#61;true&#41;</code></pre><pre><code class="plaintext code-output">(step=1) 50
(step=2) 25
(step=3) 76
(step=4) 38
(step=5) 19
(step=6) 58
(step=7) 29
(step=8) 88
(step=9) 44
(step=10) 22
(step=11) 11
(step=12) 34
(step=13) 17
(step=14) 52
(step=15) 26
(step=16) 13
(step=17) 40
(step=18) 20
(step=19) 10
(step=20) 5
(step=21) 16
(step=22) 8
(step=23) 4
(step=24) 2
(step=25) 1
25</code></pre> <p>E quindi fare cos√¨:</p> <pre><code class=language-julia >max_len &#61; 1
max_idx &#61; 1
@time for i in 1:1_000_000
	cur_len &#61; simple_collatz&#40;i&#41;
	if cur_len &gt; max_len
		global max_len &#61; cur_len
		global max_idx &#61; i
	end
end
@show max_len, max_idx</code></pre><pre><code class="plaintext code-output">  0.225570 seconds (29 allocations: 464 bytes)
(max_len, max_idx) = (525, 837799)
</code></pre> <p>Questo metodo in effetti funziona, ma diventerebbe molto lento se il limite fosse ben pi√π alto di un milione. In tal caso, l&#39;idea sarebbe di passare ad una versione ricorsiva: per calcolare la lunghezza della sequenza generata, ad esempio, da 50, consideriamo \(1 + \) la lunghezza della sequenza generata dal numero a cui conduce 50, ovvero 25. Se questo valore ci √® gi√† noto lo usiamo, altrimenti lo calcoliamo e ce lo salviamo &#40;se c&#39;√® una cella disponibile per lui nell&#39;array di appoggio, altrimenti lo calcoliamo al volo e basta&#41; in modo che sar√† eventualmente utile al calcolo della lunghezza delle sequenze generate dai numeri successivi.</p> <pre><code class=language-julia >function collatz&#40;n, lens; verbose&#61;false&#41;
    if n &lt;&#61; length&#40;lens&#41; &amp;&amp; lens&#91;n&#93; &#33;&#61; 0
        if verbose println&#40;&quot;    lui ci conduce a &#36;n che sappiamo gi√† produrre una sequenza lunga &#36;&#40;lens&#91;n&#93;&#41;&quot;&#41; end
        return lens&#91;n&#93;
    end

    if verbose println&#40;&quot;Incontriamo &#36;n per la prima volta, continuiamo con la ricorsione&quot;&#41; end
    nextn &#61; iseven&#40;n&#41; ? div&#40;n,2&#41; : 3n&#43;1
    val &#61; 1 &#43; collatz&#40;nextn, lens; verbose&#61;verbose&#41;

    if n &lt;&#61; length&#40;lens&#41;
        lens&#91;n&#93; &#61; val
    end
    return val
end</code></pre><pre><code class="plaintext code-output">collatz (generic function with 1 method)</code></pre>
<p>Esempio didattico:</p>
<pre><code class=language-julia >lens &#61; zeros&#40;Int, 20&#41;
lens&#91;1&#93; &#61; 1
for i in 2:20
    collatz&#40;i, lens; verbose&#61;true&#41;
end</code></pre><pre><code class="plaintext code-output">Incontriamo 2 per la prima volta, continuiamo con la ricorsione
    lui ci conduce a 1 che sappiamo gi√† produrre una sequenza lunga 1
Incontriamo 3 per la prima volta, continuiamo con la ricorsione
Incontriamo 10 per la prima volta, continuiamo con la ricorsione
Incontriamo 5 per la prima volta, continuiamo con la ricorsione
Incontriamo 16 per la prima volta, continuiamo con la ricorsione
Incontriamo 8 per la prima volta, continuiamo con la ricorsione
Incontriamo 4 per la prima volta, continuiamo con la ricorsione
    lui ci conduce a 2 che sappiamo gi√† produrre una sequenza lunga 2
    lui ci conduce a 4 che sappiamo gi√† produrre una sequenza lunga 3
    lui ci conduce a 5 che sappiamo gi√† produrre una sequenza lunga 6
Incontriamo 6 per la prima volta, continuiamo con la ricorsione
    lui ci conduce a 3 che sappiamo gi√† produrre una sequenza lunga 8
Incontriamo 7 per la prima volta, continuiamo con la ricorsione
Incontriamo 22 per la prima volta, continuiamo con la ricorsione
Incontriamo 11 per la prima volta, continuiamo con la ricorsione
Incontriamo 34 per la prima volta, continuiamo con la ricorsione
Incontriamo 17 per la prima volta, continuiamo con la ricorsione
Incontriamo 52 per la prima volta, continuiamo con la ricorsione
Incontriamo 26 per la prima volta, continuiamo con la ricorsione
Incontriamo 13 per la prima volta, continuiamo con la ricorsione
Incontriamo 40 per la prima volta, continuiamo con la ricorsione
Incontriamo 20 per la prima volta, continuiamo con la ricorsione
    lui ci conduce a 10 che sappiamo gi√† produrre una sequenza lunga 7
    lui ci conduce a 8 che sappiamo gi√† produrre una sequenza lunga 4
Incontriamo 9 per la prima volta, continuiamo con la ricorsione
Incontriamo 28 per la prima volta, continuiamo con la ricorsione
Incontriamo 14 per la prima volta, continuiamo con la ricorsione
    lui ci conduce a 7 che sappiamo gi√† produrre una sequenza lunga 17
    lui ci conduce a 10 che sappiamo gi√† produrre una sequenza lunga 7
    lui ci conduce a 11 che sappiamo gi√† produrre una sequenza lunga 15
Incontriamo 12 per la prima volta, continuiamo con la ricorsione
    lui ci conduce a 6 che sappiamo gi√† produrre una sequenza lunga 9
    lui ci conduce a 13 che sappiamo gi√† produrre una sequenza lunga 10
    lui ci conduce a 14 che sappiamo gi√† produrre una sequenza lunga 18
Incontriamo 15 per la prima volta, continuiamo con la ricorsione
Incontriamo 46 per la prima volta, continuiamo con la ricorsione
Incontriamo 23 per la prima volta, continuiamo con la ricorsione
Incontriamo 70 per la prima volta, continuiamo con la ricorsione
Incontriamo 35 per la prima volta, continuiamo con la ricorsione
Incontriamo 106 per la prima volta, continuiamo con la ricorsione
Incontriamo 53 per la prima volta, continuiamo con la ricorsione
Incontriamo 160 per la prima volta, continuiamo con la ricorsione
Incontriamo 80 per la prima volta, continuiamo con la ricorsione
Incontriamo 40 per la prima volta, continuiamo con la ricorsione
    lui ci conduce a 20 che sappiamo gi√† produrre una sequenza lunga 8
    lui ci conduce a 16 che sappiamo gi√† produrre una sequenza lunga 5
    lui ci conduce a 17 che sappiamo gi√† produrre una sequenza lunga 13
Incontriamo 18 per la prima volta, continuiamo con la ricorsione
    lui ci conduce a 9 che sappiamo gi√† produrre una sequenza lunga 20
Incontriamo 19 per la prima volta, continuiamo con la ricorsione
Incontriamo 58 per la prima volta, continuiamo con la ricorsione
Incontriamo 29 per la prima volta, continuiamo con la ricorsione
Incontriamo 88 per la prima volta, continuiamo con la ricorsione
Incontriamo 44 per la prima volta, continuiamo con la ricorsione
Incontriamo 22 per la prima volta, continuiamo con la ricorsione
    lui ci conduce a 11 che sappiamo gi√† produrre una sequenza lunga 15
    lui ci conduce a 20 che sappiamo gi√† produrre una sequenza lunga 8
</code></pre>
<p>Vera soluzione:</p>
<pre><code class=language-julia >lens &#61; zeros&#40;Int, 1_000_000&#41;
lens&#91;1&#93; &#61; 1
@time for i in 2:1_000_000
    collatz&#40;i, lens&#41;
end</code></pre><pre><code class="plaintext code-output">  0.058759 seconds (1.00 M allocations: 15.278 MiB, 12.45% gc time, 5.33% compilation time)
</code></pre>
<pre><code class=language-julia >risp &#61; findmax&#40;lens&#41;
@show risp</code></pre><pre><code class="plaintext code-output">risp = (525, 837799)
</code></pre>
<pre><code class=language-julia >println&#40;&quot;La catena pi√π lunga parte da n&#61;&#36;&#40;risp&#91;2&#93;&#41; ed √® lunga &#36;&#40;risp&#91;1&#93;&#41;&quot;&#41;</code></pre><pre><code class="plaintext code-output">La catena pi√π lunga parte da n=837799 ed √® lunga 525
</code></pre>
 <script src="https://giscus.app/client.js"
		data-repo="federicomor/federicomor.github.io"
		data-repo-id=R_kgDOLBdBYA 
		data-category=Announcements 
		data-category-id=DIC_kwDOLBdBYM4Clm0M 
		data-mapping=url 
		data-strict=0 
		data-reactions-enabled=1 
		data-emit-metadata=0 
		data-input-position=bottom 
		data-theme=preferred_color_scheme 
		data-lang=it 
		// data-loading=lazy  crossorigin=anonymous 
		async>
</script>
</p>
<div class=page-foot >
    
    Last modified: August 20, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the lovely <a href="https://julialang.org">Julia programming language</a>.
</div>
</div>
    </div>  
    
        <!-- <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/contrib/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script> -->

<script>
MathJax = {
	tex: {
	inlineMath: [['$', '$'], ['\\(', '\\)']],
	displayMath: [['$$','$$'], ['\\[','\\]']],
	tags: 'all'
	},
	svg: {fontCache: 'global'}
};
</script>
<script id=MathJax-script  async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    
    
        <script src="/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>